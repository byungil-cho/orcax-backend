<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>OrcaX ê´€ë¦¬ì ì£¼ë¬¸ í˜ì´ì§€</title>
  <style>
    body { font-family: Arial, sans-serif; background: #111; color: #00e0c7; padding: 2rem; }
    table { width: 100%; border-collapse: collapse; margin-top: 2rem; }
    th, td { border: 1px solid #00e0c7; padding: 0.5rem; text-align: center; }
    th { background: #222; }
    td { background: #000; }
    .hidden { display: none; }
    button { background: #ff4444; color: white; border: none; padding: 5px 10px; border-radius: 6px; cursor: pointer; }
  </style>
</head>
<body>
  <h2>ğŸ” ê´€ë¦¬ì ì „ìš© - OrcaX ì£¼ë¬¸ ë‚´ì—­</h2>

  <div id="auth">
    <p>ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:</p>
    <input type="password" id="adminPass" placeholder="ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸" />
    <button onclick="checkPassword()">í™•ì¸</button>
  </div>

  <div id="adminPanel" class="hidden">
    <table>
      <thead>
        <tr>
          <th>ì´ë¦„</th>
          <th>ì „í™”ë²ˆí˜¸</th>
          <th>ì§€ê°‘ì£¼ì†Œ</th>
          <th>ìˆ˜ëŸ‰</th>
          <th>NFT</th>
          <th>ì¼ì‹œ</th>
          <th>ì‚­ì œ</th>
        </tr>
      </thead>
      <tbody id="orderTable"></tbody>
    </table>
  </div>

  <script>
    const API_LIST = "https://orcax-backend-rdlq.onrender.com/order/list-json";
    const API_DELETE = "https://orcax-backend-rdlq.onrender.com/order/delete";

    function checkPassword() {
      const input = document.getElementById("adminPass").value;
      if (input === "2025") {
        document.getElementById("auth").classList.add("hidden");
        document.getElementById("adminPanel").classList.remove("hidden");
        loadOrders();
      } else {
        alert("âŒ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");
      }
    }

    async function loadOrders() {
      const res = await fetch(API_LIST);
      const orders = await res.json();
      const table = document.getElementById("orderTable");
      table.innerHTML = "";

      orders.forEach(o => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${o.name}</td>
          <td>${o.phone}</td>
          <td>${o.wallet}</td>
          <td>${o.quantity}</td>
          <td>${o.nft}</td>
          <td>${new Date(o.createdAt).toLocaleString()}</td>
          <td><button onclick="deleteOrder('${o._id}')">ì‚­ì œ</button></td>
        `;
        table.appendChild(tr);
      });
    }

    async function deleteOrder(id) {
      if (!confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
      const res = await fetch(API_DELETE, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ id })
      });
      const result = await res.json();
      if (result.success) {
        alert("âœ… ì‚­ì œ ì™„ë£Œ");
        loadOrders();
      } else {
        alert("âŒ ì‚­ì œ ì‹¤íŒ¨");
      }
    }
  </script>
</body>
</html>
